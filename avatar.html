<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Venux - Avatar</title>
<link rel="icon" type="image/png" href="https://raw.githubusercontent.com/ayytrix/ventest1/refs/heads/main/venux.png">
<style>
  body {
    margin: 0;
    background-color: #d4d4d4;
    font-family: Arial, sans-serif;
    font-size: 13px;
    color: #222;
  }
  #main-header {
    background: linear-gradient(to bottom, #1a4a84 0%, #0b2c5a 100%);
    padding: 10px 20px;
    border-bottom: 2px solid #071b36;
    display: flex;
    align-items: center;
  }
  #main-header img { height: 52px; object-fit: contain; }
  #sub-header {
    background: linear-gradient(to bottom, #1a4a84 0%, #0b2c5a 100%);
    padding: 8px 15px;
    border-bottom: 1px solid #000;
  }
  #sub-header a {
    color: white;
    text-decoration: none;
    margin-right: 20px;
    font-weight: bold;
  }
  #sub-header a:hover { text-decoration: underline; }
  #page-content { padding: 20px; }
  .avatar-preview {
    background: #b0b0b0;
    border: 3px solid #777;
    width: 200px;
    height: 200px;
    margin: 10px auto;
    display: flex;
    align-items: center;
    justify-content: center;
    image-rendering: pixelated;
    box-shadow: 2px 2px 0 #777;
  }
  #avatarImage {
    width: 128px;
    height: 128px;
    filter: contrast(90%) brightness(110%) saturate(90%);
  }
  .equip-section {
    margin-top: 20px;
    background: #eee;
    border: 2px solid #999;
    padding: 10px;
    box-shadow: 2px 2px 0 #aaa;
  }
  .equip-section h3 {
    margin-top: 0;
  }
  .item {
    display: inline-block;
    border: 1px solid #999;
    background: #fff;
    padding: 5px;
    margin: 5px;
    cursor: pointer;
    text-align: center;
    width: 80px;
  }
  .item img {
    width: 64px;
    height: 64px;
    display: block;
    margin: 0 auto 4px;
    image-rendering: pixelated;
  }
  .item.equipped {
    background: #cce0ff;
    border: 2px solid #0055aa;
  }
</style>
</head>
<body>
  <div id="main-header">
    <img src="https://raw.githubusercontent.com/ayytrix/ventest1/refs/heads/main/venux.png" alt="Venux">
  </div>

  <div id="sub-header">
    <a href="Home.html">Home</a> |
    <a href="Games.html">Games</a> |
    <a href="Catalog.html">Catalog</a> |
    <a href="Users.html">Users</a> |
    <a href="Avatar.html">Avatar</a> |
    <a href="Forums.html">Forum</a>
  </div>

  <div id="page-content">
    <h2>Your Avatar</h2>
    <div class="avatar-preview">
      <img id="avatarImage" src="https://raw.githubusercontent.com/ayytrix/ventest1/refs/heads/main/venux-default-avatar.png" alt="Avatar">
    </div>

    <div class="equip-section">
      <h3>Hats</h3>
      <div id="hats"></div>
    </div>

    <div class="equip-section">
      <h3>Shirts</h3>
      <div id="shirts"></div>
    </div>

    <div class="equip-section">
      <h3>Pants</h3>
      <div id="pants"></div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBPmJ-QYXZ41gx-4PjCpUPuw7DLnDq0JFg",
      authDomain: "venux1.firebaseapp.com",
      projectId: "venux1",
      storageBucket: "venux1.appspot.com",
      messagingSenderId: "231055963335",
      appId: "1:231055963335:web:34c2f52fca2191b3d0bae2"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const hatsDiv = document.getElementById("hats");
    const shirtsDiv = document.getElementById("shirts");
    const pantsDiv = document.getElementById("pants");
    const avatarImage = document.getElementById("avatarImage");

    // test item list (youâ€™ll replace these with real ones later)
    const items = {
      hats: [
        { id: "classicCap", name: "Classic Cap", img: "https://static.wikia.nocookie.net/roblox/images/d/d4/ClassicCap.png" },
        { id: "noHat", name: "No Hat", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/Transparent.png/1200px-Transparent.png" }
      ],
      shirts: [
        { id: "blueShirt", name: "Blue Shirt", img: "https://static.wikia.nocookie.net/roblox/images/9/9a/ClassicBlueShirt.png" },
        { id: "redShirt", name: "Red Shirt", img: "https://static.wikia.nocookie.net/roblox/images/0/0f/ClassicRedShirt.png" }
      ],
      pants: [
        { id: "jeans", name: "Jeans", img: "https://static.wikia.nocookie.net/roblox/images/0/0a/Jeans.png" },
        { id: "blackPants", name: "Black Pants", img: "https://static.wikia.nocookie.net/roblox/images/3/31/ClassicBlackPants.png" }
      ]
    };

    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        window.location.href = "Login.html";
        return;
      }

      const avatarRef = doc(db, "users", user.uid, "avatar", "equipped");
      let equipped = { hat: null, shirt: null, pants: null };

      const snap = await getDoc(avatarRef);
      if (snap.exists()) equipped = snap.data();

      function renderItems(section, type) {
        section.innerHTML = "";
        items[type].forEach(item => {
          const div = document.createElement("div");
          div.className = "item" + (equipped[type] === item.id ? " equipped" : "");
          div.innerHTML = `<img src="${item.img}" alt="${item.name}"><span>${item.name}</span>`;
          div.addEventListener("click", async () => {
            equipped[type] = equipped[type] === item.id ? null : item.id;
            await setDoc(avatarRef, equipped);
            renderAll();
          });
          section.appendChild(div);
        });
      }

      async function renderAll() {
        renderItems(hatsDiv, "hat");
        renderItems(shirtsDiv, "shirt");
        renderItems(pantsDiv, "pants");
        // basic fake "render"
        const parts = [];
        if (equipped.shirt) parts.push(items.shirts.find(s => s.id === equipped.shirt)?.img);
        if (equipped.pants) parts.push(items.pants.find(p => p.id === equipped.pants)?.img);
        if (equipped.hat) parts.push(items.hats.find(h => h.id === equipped.hat)?.img);
        avatarImage.src = parts[0] || "https://raw.githubusercontent.com/ayytrix/ventest1/refs/heads/main/venux-default-avatar.png";
      }

      renderAll();
    });
  </script>
</body>
</html>
